<div class="ph4 bg-white">
  <h2 class="pv3">Hi, {{main.user.username}}. These are your widgets</h2>
  <!-- change how the gridster directive behaves in the vm.gridsterOpts in WidgetsIndexCtrl -->
  <div gridster="widgets.gridsterOpts">
    <div class="overflow-auto grid-item ba bg-white b--gray cover" gridster-item="item" col="item.col" row="item.row" size-x="item.sizeX" size-y="item.sizeY" ng-repeat="item in widgets.all">

      <button class="fr mt2 mr2" ng-click="widgets.delete(item)">Delete</button>

      <!-- <p>Size: {{item.sizeX}}, {{item.sizeY}} Pos: {{item.col}}, {{item.row}}</p> -->

      <div ng-if="item.type === 'cat'"
      style="background-image: url({{item.url}})" class="pa2 cover cat h-100">
      </div>

      <div ng-if="item.type === 'giphy'"
      style="background-image: url('{{item.data.data[item.index].images.original.url}}')"
      class="pa2 cover bg-center h5 h-100-ns">
      <button ng-click="widgets.nextItem(item)">Moar!!</button>
      </div>

      <h2 ng-if="item.type === 'weather' && item.data.cod !== 200">City not found.</h2>
      <div ng-if="item.type === 'weather' && item.data.cod === 200" class="pa2">

        <img class="db-ns dib v-mid" width="40" ng-if="item.data.weather[0].main === 'Clear'" ng-src="{{widgets.icons.sunny.url}}">
        <img class="db-ns dib v-mid" width="40" ng-if="item.data.weather[0].main === 'Rain'" ng-src="{{widgets.icons.rain.url}}">
        <img class="db-ns dib v-mid" width="40" ng-if="item.data.weather[0].main === 'Clouds'" ng-src="{{widgets.icons.cloudy.url}}">

        <dl class="db-ns dib">
          <dt class="dib m0 b">{{item.data.name}}, {{item.data.sys.country}}:</dt>
          <dd class="dib m0" ng-repeat="weather in item.data.weather">{{ weather.main }}<span ng-if="!$last">, </span>
          </dd>
          {{ (item.data.main.temp - 273.15).toFixed(2)}}&deg;C
        </dl>
      </div>

      <h2 ng-if="item.type === 'news' && item.data.status != 'ok'">News failed to load :(</h2>
      <div ng-if="item.type === 'news' && item.data.status === 'ok'"
        style="background-image: url({{item.data.articles[item.index].urlToImage}})"
        class="grid-news pa2 h-100 cover">
        <button class="fr" ng-click="widgets.nextItem(item)">Next article</button>
        <!-- this ng-if stops the author being displayed if it's a link -->
        <h4 class="" ng-if="item.data.articles[item.index].author.split('http').length === 1">{{ item.data.articles[item.index].author }}</h4>
        <h3 class="f5 f4-l pt1"><a target="_blank" class="black" href="{{item.data.articles[0].url}}">{{ item.data.articles[item.index].title }}</a></h3>
        <p class="pt1">{{ item.data.articles[item.index].description }}</p>

      </div>

      <div ng-if="item.type === 'breakfast'">
        <h3>{{ item.data.hits[0].recipe.label }}</h3>
        <ul>
          <li ng-repeat="ingredient in item.data.hits[0].recipe.ingredientLines">
            {{ ingredient }}
          </li>
        </ul>
        <p>{{ item.data.hits[0].recipe.calories | number : 0 }}kcal</p>
      </div>

      <div ng-if="item.type === 'advice'">
        <h3>Wise Words of the Day</h3>
        <h4>{{ item.data.slip.advice }}</h4>
      </div>

      <!-- <div ng-if="item.type === 'numberFact'">
        <h3>Number Fact of the Day</h3>
        <h5>Today is the {{ date }} day of the year</h5>
        <h4>{{ item.data.text }}</h4>
      </div> -->

      <div ng-if="item.type === 'today'">
        <h3>On this day in history...</h3>
        <h4>In {{item.data.data.Events[0].year}}</h4>
        <h4>{{ item.data.data.Events[0].text }}</h4>
      </div>

      <div ng-if="item.type === 'chuck'">
        <h4>{{ item.data.value }}</h4>
      </div>

      <div ng-if="item.type === 'quote'">
        <h3>{{ item.data[0].title }}</h3>
        {{ item.data[0].content }}
      </div>

      <div ng-if="item.type === 'ron'">
        <h3>{{ item.data[0]}}</h3>
        <p>-Ron Swanson</p>

      </div>

    </div>
  </div>

</div>
